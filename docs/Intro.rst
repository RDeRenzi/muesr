Basic theory
====================

Local fields in MuSR
---------------------

Muon spin rotation and relaxation spectroscopy is mainly used to probe magnetic materials.
We briefly describe here the interactions involved between the muon and the electrons.

[TODO]

Description of Magnetic Structures
-----------------------------------

There are two possibilities to describe a magnetic structure: using the
colored group theory or with the propagation vector and Fourier 
coefficients formalism. :mod:`muesr` opts for the latter.
A magnetic structure is defined as

.. math::

   \mathbf{\mu_{n \nu}} = \sum _{\mathbf{k}} \mathbf{m}_{\nu \mathbf{k}} e ^{- 2 \pi i \mathbf{k} \cdot \mathbf{R}_n}
   
where :math:`\nu` runs over the atoms of the unit cell and :math:`n` 
identifies the n-th cell where atomic positions :math:`\mathbf{R}_{n\nu}` 
are obtained according to

.. math::

   \mathbf{R}_{n\nu} = \mathbf{R}_{n} + \mathbf{r_\nu}
   
with :math:`\mathbf{R}_{n} = n_a \mathbf{a} + n_b \mathbf{b} + n_c \mathbf{c}` 
and :math:`\mathbf{r}_\nu = x_\nu \mathbf{a} + y_\nu \mathbf{b} + z_\nu \mathbf{c}`.

The fourier coefficients :math:`m_{\nu \mathbf{k}}` are three dimensional
complex vectors. They are related to the  irreducible representations 
of the so called "little groups" i.e. the subgroup of the crystallographic space 
group formed by the operators leaving invariant the propagation vector.



[TODO] Discuss the phase!


:mod:`muesr` can only handle 1-k magnetic structures.
However, since local field are linear in the magnetic moment, the
results for multiple-k magnetic orders can be obtained by performing 
multiple simulations for each of the k vectors describing the system
and summing the results.

Implementation details
----------------------------

:mod:`muesr` is a tool to analyze muon sites and local field contributions
generated by a known magnetic structure. It is intended to be used in an 
interactive python environment such ipython or Jupyter notebooks.

Internally, muesr uses Tesla units and Angstrom for lengths if not 
specified. Magnetic moments are specified in units of Bohr magnetons.

There are many conventions to specify the magnetic structures:

http://magcryst.org/resources/magnetic-coordinates/

At the current stage :py:mod:`muesr` supports:

1. Bohr Magneton/Angstrom units, with x||a, y||b and z||c
    This is the reduced lattice coordinate system, where the magnetic metric tensor (M) is the same metric used for interatomic distances (G).

2. Bohr Magneton units, with x||a, y||b and z||c
    This is the crystal-axis coordinate system, where components of the moment are defined by their projections along the lattice basis vectors.
    If we define L = {{a,0,0},{0,b,0},{0,0,c}}, then the magnetic metric tensor is M = L.G.L^(-1), which is unitless.
    
In addition, fourier coefficients can also be specified in Cartesian coordinates (the same used to define
the lattice parameters).

Useful readings
---------------
http://www.neutron-sciences.org/articles/sfn/pdf/2014/01/sfn201402001.pdf
